mixin planSelectList(listID)
  - optionCount = 0
  ul(id=listID)
    block
  atlantis:webstash(type="js")
    script(type="text/javascript").
      $("#!{listID}").sfDropList({
        width:320
      });

mixin addPlanOption(duration, pfid, plan)
  - optionCount++
  li(data-value=optionCount,data-plan=plan)
    .sf-droplist-row(data-main='true')
      span.sf-droplist-term !{duration} mo
      span.sf-droplist-cost.sf-droplist-sale [@T[productprice:<current productid="!{pfid}" dropdecimal="false" period="monthly" htmlsymbol="false" negative="parentheses" />]@T]/mo
      | 
      |##if(productHasSavingsMoreThan(!{pfid}, !{pfid}, 0))
      | 
      span.sf-droplist-msg.sf-droplist-sale ON SALE
    .sf-droplist-row
      span.sf-droplist-term Â 
      span.sf-droplist-cost
        strike [@T[productprice:<list productid="!{pfid}" dropdecimal="false" period="monthly" htmlsymbol="false" negative="parentheses" />]@T]/mo
      span.sf-droplist-msg.sf-droplist-sale Save [@T[productcompare:<percent primaryproductid="!{pfid}" secondaryproductid="!{pfid}" showsymbol="true" hidebelow="5"><html><![CDATA[{0}]]></html></percent>]@T]
      | 
      |##endif
      | 

//- here are the fields that can be set on inheriting classes
block vars
  - title = "";
  - subTitle = "";
  - description = "";
  - features = "";
  - checkFeatures = "";
  - disclaimer = "";
  - pfid = "";
  - packageids = "";
  - promocode = "";
  - defaultPlan = "";
  - flagText = "";
  - tcode = "";
  - listID = "";
  - buttonid = "";
  - buttonText = "";
  - showDropDownList = false;
  - buttonUrl = "";
  - priceText = "";
  - term = "";


atlantis:webstash(type="css")
  block styles
    style.
      .pro-plans { margin-top: 0; }
      .form-control { margin-bottom: 10px; }

.pro-plan-wrap
  block flag
    if (flagText)
      div.plan-flag !{flagText}

  block title
    if (title)
      h2.plan-title !{title}

  block subTitle
    if (subTitle)
      h5.plan-subtitle !{subTitle}

  block description
    if (description)
      p.plan-text !{description}

  block price
    if (pfid)
      .plan-price-wrap
        if(priceText) 
          strong !{priceText}
          br
        span.plan-price.text-warning [@T[productprice:<current productid="!{pfid}" dropdecimal="false" period="monthly" htmlsymbol="false" negative="parentheses" />]@T]
        span.plan-duration.text-warning !{term}
        | 
        |##if(productHasSavingsMoreThan(!{pfid}, !{pfid}, 0))
        | 
        br
        strong
          | [@L[cds.sales/_common:was]@L] 
          strike [@T[productprice:<list productid="!{pfid}" dropdecimal="false" period="monthly" htmlsymbol="false" negative="parentheses" />]@T]
          |  
          span.text-primary [@L[cds.sales/_common:save-cap]@L] [@T[productcompare:<percent primaryproductid="!{pfid}" secondaryproductid="!{pfid}" showsymbol="true" hidebelow="5"><html><![CDATA[{0}]]></html></percent>]@T]
        | 
        |##endif
        | 
    if (packageids)
      .plan-price-wrap
        span.plan-price.text-warning [@T[multipleproductprice:<current productidlist="!{packageids}" period="monthly" promocode="!{promocode}" />]@T]
        span.plan-duration.text-warning !{term}
        
  if(showDropDownList)
    +planSelectList(listID)
      block planOptions

  block legalDisclaimer
    if(disclaimer)
      div !{disclaimer}

  block button
    if (buttonText && buttonUrl)
      a.btn.btn-primary.btn-plan.btn-lg.btn-block(href!=buttonUrl data-tcode!=tcode data-index="1") !{buttonText}
    else if(buttonText && showDropDownList )
      button.btn.btn-purchase.btn-plan.btn-lg.btn-block(data-tcode="#{tcode}",data-ul="#{listID}") !{buttonText}
    else if (buttonText && !showDropDownList && defaultPlan && buttonid)
      button.btn.btn-purchase.btn-plan.btn-lg.btn-block(id=buttonid ,data-tcode="#{tcode}",data-plan="#{defaultPlan}") !{buttonText}
    else
      button.btn.btn-purchase.btn-plan.btn-lg.btn-block(data-tcode="#{tcode}") No Action

  block features
    //- Feature list
    if(features)
      each feature, index in features
        //- Text at the bottom that can have multiple "rows"
        .plan-item !{feature}

  block checkFeatures
    if(checkFeatures)
      each feature, index in checkFeatures
          //- Text at the bottom that can have multiple "rows"
          .include-check.check-item !{feature}
